{#
$lt-small-handheld - Breakpoint for (**smaller than**) smaller handheld devices (<=319px).
$lt-medium-handheld - Breakpoint for (**smaller than**) medium sized handheld devices (<=519px).
$lt-large-handheld - Breakpoint for (**smaller than**) larger handheld devices and smaller desktop devices (<=767px).
$lt-small-desktop - Breakpoint for (**smaller than**) medium sized handheld and small desktop devices (<=1023px).
$lt-medium-desktop - Breakpoint for (**smaller than**) Breakpoint for large (desktop) devices (<=1259px).
$lt-large-desktop - Breakpoint for (**smaller than**) Breakpoint for large (desktop) devices (<=1439px).

$gt-small-handheld - Breakpoint for (**larger than**) smaller handheld devices (>=320px).
$gt-medium-handheld - Breakpoint for (**larger than**) medium sized handheld devices (>=520px).
$gt-large-handheld - Breakpoint for (**larger than**) larger handheld devices and smaller desktop devices (>=768px).
$gt-small-desktop - Breakpoint for (**larger than**) medium sized handheld and small desktop devices (>=1024px).
$gt-medium-desktop - Breakpoint for (**larger than**) Breakpoint for large (desktop) devices (>=1260px).
$gt-large-desktop - Breakpoint for (**larger than**) Breakpoint for large (desktop) devices (>=1440px).

$portrait - Breakpoint for portrait oriented viewports.
$landscape - Breakpoint for landscape oriented viewports.
#}

{% macro triptych(image) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <picture class="image image--stretch">
        <source
            media="(min-width: 768px)"
            srcset="https://res.cloudinary.com/cta/image/upload/h_360,w_750,f_auto,c_fill/{{ image.metadata.id }} 750w,
                    https://res.cloudinary.com/cta/image/upload/h_360,w_600,f_auto,c_fill/{{ image.metadata.id }} 600w,
                    https://res.cloudinary.com/cta/image/upload/h_360,w_400,f_auto,c_fill/{{ image.metadata.id }} 400w"
            sizes="44vw"
            />
        <source
            media="(min-width: 480px)"
            srcset="https://res.cloudinary.com/cta/image/upload/h_360,w_800,f_auto,c_fill/{{ image.metadata.id }} 800w"
            sizes="100vw"
            />
        {# Fallback, smallest handheld #}
        <img
            class="image image--stretch"
            src="https://res.cloudinary.com/cta/image/upload/h_360,ar_1:1,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/h_720,ar_1:1,f_auto,c_fill/{{ image.metadata.id }} 720w,
                    https://res.cloudinary.com/cta/image/upload/h_360,ar_1:1,f_auto,c_fill/{{ image.metadata.id }} 360w"
            alt="100vw"
            />
    </picture>
{% endmacro %}

{% macro triptych_hero(image_src) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <picture class="image image--stretch">
        <source
            media="(min-width: 1024px)"
            srcset="https://res.cloudinary.com/cta/image/upload/h_720,w_940,f_auto,c_fill/{{ image.metadata.id }} 940w,
                    https://res.cloudinary.com/cta/image/upload/h_720,w_800,f_auto,c_fill/{{ image.metadata.id }} 800w,
                    https://res.cloudinary.com/cta/image/upload/h_720,w_600,f_auto,c_fill/{{ image.metadata.id }} 600w"
            sizes="66vw"
            />
        <source
            media="(min-width: 480px)"
            srcset="https://res.cloudinary.com/cta/image/upload/h_360,w_800,f_auto,c_fill/{{ image.metadata.id }} 800w,
                    https://res.cloudinary.com/cta/image/upload/h_360,w_800,f_auto,c_fill/{{ image.metadata.id }} 400w"
            sizes="100vw"
            />
        {# Fallback, smallest handheld #}
        <img
            class="image image--stretch"
            src="https://res.cloudinary.com/cta/image/upload/h_360,ar_1:1,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/h_720,ar_1:1,f_auto,c_fill/{{ image.metadata.id }} 720w,
                    https://res.cloudinary.com/cta/image/upload/h_360,ar_1:1,f_auto,c_fill/{{ image.metadata.id }} 360w"
            sizes="100vw"
            width="360"
            height="360"
            alt=""
            />
    </picture>
{% endmacro %}

{% macro contact(image) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <picture class="image image--stretch">
        <source
            media="(min-width: 1024px)"
            srcset="https://res.cloudinary.com/cta/image/upload/h_720,w_940,f_auto,c_fill/{{ image.metadata.id }} 940w,
                    https://res.cloudinary.com/cta/image/upload/h_720,w_800,f_auto,c_fill/{{ image.metadata.id }} 800w,
                    https://res.cloudinary.com/cta/image/upload/h_720,w_600,f_auto,c_fill/{{ image.metadata.id }} 600w"
            sizes="66vw"
            />
        <source
            media="(min-width: 480px)"
            srcset="https://res.cloudinary.com/cta/image/upload/h_360,w_800,f_auto,c_fill/{{ image.metadata.id }} 800w,
                    https://res.cloudinary.com/cta/image/upload/h_360,w_800,f_auto,c_fill/{{ image.metadata.id }} 400w"
            sizes="100vw"
            />
        {# Fallback, smallest handheld #}
        <img
            class="image image--stretch"
            src="https://res.cloudinary.com/cta/image/upload/h_360,ar_1:1,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/h_720,ar_1:1,f_auto,c_fill/{{ image.metadata.id }} 720w,
                    https://res.cloudinary.com/cta/image/upload/h_360,ar_1:1,f_auto,c_fill/{{ image.metadata.id }} 360w"
            sizes="100vw"
            width="360"
            height="360"
            alt=""
            />
    </picture>
{% endmacro %}

{% macro post(mediaObject) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    {#  This is testing for an image on Cloudinary but the logic is shakey at best. 
        We should test if the image actually exist by requesting a header but this macro 
        is used often on a page so that would be a big performance hit. Assuming the 
        object is recently updated instead. #}

    {% if mediaObject.originalFilename is defined %}
        {% set imageId = mediaObject.originalFilename|default('wwewgktde0mnowuzrvmi') %}
    {% else %}
        {% set imageId = mediaObject.metadata.id|default(mediaObject.external.data.public_id)|default('wwewgktde0mnowuzrvmi') %}
    {% endif %}

    <img
        class="image image--stretch"
        src="https://res.cloudinary.com/cta/image/upload/w_240,ar_3:2,f_auto,c_fill/{{ imageId }}"
        srcset="https://res.cloudinary.com/cta/image/upload/w_500,ar_3:2,f_auto,c_fill/{{ imageId }} 500w,https://res.cloudinary.com/cta/image/upload/w_320,ar_3:2,f_auto,c_fill/{{ imageId }} 320w,https://res.cloudinary.com/cta/image/upload/w_240,ar_3:2,f_auto,c_fill/{{ imageId }} 240w,https://res.cloudinary.com/cta/image/upload/w_160,ar_3:2,f_auto,c_fill/{{ imageId }} 160w"
        sizes="(min-width: 1024px) 17vw, (min-width: 768px) 50vw"
        width="160"
        height="240"
        alt=""
        itemprop="image"
        />
{% endmacro %}

{% macro post_hero(image, classes) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <img
        class="image image--stretch {{ classes }}"
        src="https://res.cloudinary.com/cta/image/upload/w_750,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }}"
        srcset="https://res.cloudinary.com/cta/image/upload/w_1480,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 1500w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 1280w,https://res.cloudinary.com/cta/image/upload/w_740,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 750w,https://res.cloudinary.com/cta/image/upload/w_640,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 640w,https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 480w,https://res.cloudinary.com/cta/image/upload/w_320,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 320w"
        sizes="(min-width: 1024px) 50vw, (min-width: 768px) 100vw"
        width="360"
        height="240"
        alt=""
        itemprop="image"
        />
{% endmacro %}

{% macro carousel(image, classes) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <img
        class="{{ classes|default('image image--stretch') }}"
        src="https://res.cloudinary.com/cta/image/upload/w_750,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }}"
        srcset="https://res.cloudinary.com/cta/image/upload/w_1480,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 1500w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 1280w,https://res.cloudinary.com/cta/image/upload/w_640,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 750w,https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 640w,https://res.cloudinary.com/cta/image/upload/w_320,ar_1:1,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 480w,https://res.cloudinary.com/cta/image/upload/w_320,ar_1:1,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 320w"
        sizes="(min-width: 1024px) 50vw, (min-width: 768px) 100vw"
        width="360"
        height="240"
        alt=""
        itemprop="image"
        />
{% endmacro %}

{% macro speaker(url) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <img
        src="{{ url }}"
        alt=""
        />
{% endmacro %}


{% macro profile_photo(url, alt) %}
    <img
        src="{{ url }}"
        alt="{{ alt }}"
    />
{% endmacro %}

{% macro person(person, size) %}

    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    {% if person.gender == "Male" %}
        {% set avatar = person.avatar|default('https://res.cloudinary.com/cta/image/upload/ijy2iwobbptvyv2dqhbl.png') %}
    {% else %}
        {% set avatar = person.avatar|default('https://res.cloudinary.com/cta/image/upload/lflynd2nauvodwfld0al.png') %}
    {% endif %}

    {% set imagebasename = avatar|getFileBaseName() %}

    <img
        src="{{ 'https://res.cloudinary.com/cta/image/upload/w_' ~ size ~ ',h_' ~ size ~ ',f_auto,g_faces:center,c_fill/' ~ imagebasename|default(fallback) }}"
        width="{{ size }}"
        height="{{ size }}"
        alt="{{ (person.honorificPrefix ~ ' ' ~ person.givenName ~ ' ' ~ person.familyName)|trim }}"
        itemprop="image"
    />
{% endmacro %}

{% macro speaker(person) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    {% if person.gender == "Male" %}
        {% set fallback = 'https://res.cloudinary.com/cta/image/upload/ijy2iwobbptvyv2dqhbl.png' %}
    {% else %}
        {% set fallback = 'https://res.cloudinary.com/cta/image/upload/lflynd2nauvodwfld0al.png' %}
    {% endif %}

    <img
        src="{{ person.avatar|default(fallback) }}"
        alt="{{ (person.honorificPrefix ~ ' ' ~ person.givenName ~ ' ' ~ person.familyName)|trim }}"
        itemprop="image"
    />
{% endmacro %}

{% macro hero(image, crowned, classes) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    {% if crowned %}
    <picture class="crown {{ classes|default("image image--stretch") }}">
        {# smartphone portrait #}
        <source
            media="(max-width: 767px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# smartphone landscape #}
        <source
            media="(max-width: 767px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# iPad portrait and landscape #}
        <source
            media="(min-width: 768px) and (max-width: 830px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2048,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2048w,https://res.cloudinary.com/cta/image/upload/w_1536,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1024,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1024w,https://res.cloudinary.com/cta/image/upload/w_768,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w"
            sizes="100vw"
            />
        <source
            media="(min-width: 830px) and (max-width: 1023px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2048,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2048w,https://res.cloudinary.com/cta/image/upload/w_1536,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1024,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1024w,https://res.cloudinary.com/cta/image/upload/w_768,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w"
            sizes="100vw"
            />
        {# Samsung tablet portrait #}
        <source
            media="(min-height: 800px) and (max-height: 1280px) and (min-width: 800px) and (max-width: 1280px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1600,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1600w,https://res.cloudinary.com/cta/image/upload/w_800,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 800w"
            sizes="100vw"
            />
        {# Samsung tablet landscape #}
        <source
            media="(min-width: 1280px) and (max-width: 600px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_2:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_2:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# 16:9 #}
        <source
            media="(min-aspect-ratio: 16/9)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:7,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:7,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:7,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:7,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:7,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# > 1:1 #}
        <source
            media="(min-aspect-ratio: 1/1)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# < 1:1 #}
        <source
            media="(max-aspect-ratio: 1/1)"
            srcset="
                https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# Fallback, smallest handheld - crop square so landscape and portrait orientations are supported #}
        <img
            class="{{ classes|default("image image--stretch") }}"
            src="https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/w_960,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            alt="{{ image.metadata.title|t(locales)|default("Leading image") }}"
            itemprop="image"
            />
    </picture>
    {% else %}
    <picture class="not-crown {{ classes|default("image image--stretch") }}">
        {# smartphone portrait #}
        <source
            media="(max-width: 767px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# smartphone landscape #}
        <source
            media="(max-width: 767px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# iPad portrait and landscape #}
        <source
            media="(min-width: 768px) and (max-width: 1024px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2048,ar_2:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2048w,https://res.cloudinary.com/cta/image/upload/w_1536,ar_2:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1024,ar_2:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1024w,https://res.cloudinary.com/cta/image/upload/w_768,ar_2:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w"
            sizes="100vw"
            />
        {# Samsung tablet portrait #}
        <source
            media="(min-height: 800px) and (max-height: 1280px) and (min-width: 800px) and (max-width: 1280px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1600,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1600w,https://res.cloudinary.com/cta/image/upload/w_800,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 800w"
            sizes="100vw"
            />
        {# Samsung tablet landscape #}
        <source
            media="(min-width: 1280px) and (max-width: 600px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_3:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_3:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# 16:9 #}
        <source
            media="(min-aspect-ratio: 16/9) and (min-width: 1800px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:5,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:5,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:5,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:5,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:5,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# > 1:1 #}
        <source
            media="(min-aspect-ratio: 1/1)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# < 1:1 #}
        <source
            media="(max-aspect-ratio: 1/1)"
            srcset="
                https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# Fallback, smallest handheld - crop square so landscape and portrait orientations are supported #}
        <img
            class="{{ classes|default("image image--stretch") }}"
            src="https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/w_960,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            alt="{{ image.metadata.title|t(locales)|default("Leading image") }}"
            itemprop="image"
            />
    </picture>
    {% endif %}
{% endmacro %}

{% macro hero_twitter(image, crowned, classes) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    {% if crowned %}
    <picture class="crown {{ classes|default("image image--stretch") }}">
        {# smartphone portrait #}
        <source
            media="(max-width: 767px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# smartphone landscape #}
        <source
            media="(max-width: 767px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# iPad portrait and landscape #}
        <source
            media="(min-width: 768px) and (max-width: 830px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2048,ar_1:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2048w,https://res.cloudinary.com/cta/image/upload/w_1536,ar_1:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1024,ar_1:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1024w,https://res.cloudinary.com/cta/image/upload/w_768,ar_1:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w"
            sizes="100vw"
            />
        <source
            media="(min-width: 830px) and (max-width: 1023px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2048,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2048w,https://res.cloudinary.com/cta/image/upload/w_1536,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1024,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1024w,https://res.cloudinary.com/cta/image/upload/w_768,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w"
            sizes="100vw"
            />
        {# Samsung tablet portrait #}
        <source
            media="(min-height: 800px) and (max-height: 1280px) and (min-width: 800px) and (max-width: 1280px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1600,ar_1:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1600w,https://res.cloudinary.com/cta/image/upload/w_800,ar_1:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 800w"
            sizes="100vw"
            />
        {# Samsung tablet landscape #}
        <source
            media="(min-width: 1280px) and (max-width: 600px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# 16:9 #}
        <source
            media="(min-aspect-ratio: 16/9)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# > 1:1 #}
        <source
            media="(min-aspect-ratio: 1/1)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# < 1:1 #}
        <source
            media="(max-aspect-ratio: 1/1)"
            srcset="
                https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:10,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# Fallback, smallest handheld - crop square so landscape and portrait orientations are supported #}
        <img
            class="{{ classes|default("image image--stretch") }}"
            src="https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/w_960,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            alt="{{ image.metadata.title|t(locales)|default("Leading image") }}"
            />
    </picture>
    {% else %}
    <picture class="not-crown {{ classes|default("image image--stretch") }}">
        {# smartphone portrait #}
        <source
            media="(max-width: 767px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# smartphone landscape #}
        <source
            media="(max-width: 767px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1536,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1334,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1334w,https://res.cloudinary.com/cta/image/upload/w_1136,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1136w,https://res.cloudinary.com/cta/image/upload/w_960,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_768,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w,https://res.cloudinary.com/cta/image/upload/w_667,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 667w,https://res.cloudinary.com/cta/image/upload/w_568,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 568w,https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            />
        {# iPad portrait and landscape #}
        <source
            media="(min-width: 768px) and (max-width: 1024px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2048,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2048w,https://res.cloudinary.com/cta/image/upload/w_1536,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1536w,https://res.cloudinary.com/cta/image/upload/w_1024,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1024w,https://res.cloudinary.com/cta/image/upload/w_768,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 768w"
            sizes="100vw"
            />
        {# Samsung tablet portrait #}
        <source
            media="(min-height: 800px) and (max-height: 1280px) and (min-width: 800px) and (max-width: 1280px) and (orientation: portrait)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_1600,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1600w,https://res.cloudinary.com/cta/image/upload/w_800,ar_2:3,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 800w"
            sizes="100vw"
            />
        {# Samsung tablet landscape #}
        <source
            media="(min-width: 1280px) and (max-width: 600px) and (orientation: landscape)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_3:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_3:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# 16:9 #}
        <source
            media="(min-aspect-ratio: 16/9) and (min-width: 1800px)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:6,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# > 1:1 #}
        <source
            media="(min-aspect-ratio: 1/1)"
            srcset="
            https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# < 1:1 #}
        <source
            media="(max-aspect-ratio: 1/1)"
            srcset="
                https://res.cloudinary.com/cta/image/upload/w_2560,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 2560w,https://res.cloudinary.com/cta/image/upload/w_1920,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1920w,https://res.cloudinary.com/cta/image/upload/w_1680,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1680w,https://res.cloudinary.com/cta/image/upload/w_1440,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1440w,https://res.cloudinary.com/cta/image/upload/w_1280,ar_16:8,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 1280w"
            sizes="100vw"
            />
        {# Fallback, smallest handheld - crop square so landscape and portrait orientations are supported #}
        <img
            class="{{ classes|default("image image--stretch") }}"
            src="https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/w_960,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_480,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="100vw"
            alt="{{ image.metadata.title|t(locales)|default("Leading image") }}"
            />
    </picture>
    {% endif %}
{% endmacro %}

{% macro post_tile(image, class) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <picture class="{{ class|default('image image--stretch') }}">
        <source
            media="(max-width: 767px)"
            srcset="
                https://res.cloudinary.com/cta/image/upload/w_600,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 600w,https://res.cloudinary.com/cta/image/upload/w_400,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 400w,https://res.cloudinary.com/cta/image/upload/w_300,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 300w,https://res.cloudinary.com/cta/image/upload/w_200,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 200w"
            sizes="100vw"
            />
        <source
            media="(min-width: 768px)"
            srcset="
                https://res.cloudinary.com/cta/image/upload/w_600,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 600w,https://res.cloudinary.com/cta/image/upload/w_400,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 400w,https://res.cloudinary.com/cta/image/upload/w_300,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 300w,https://res.cloudinary.com/cta/image/upload/w_200,ar_1:1,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 200w"
            sizes="15vw"
            />
        <img
            class="{{ classes|default("image image--stretch") }}"
            src="https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }}"
            srcset="https://res.cloudinary.com/cta/image/upload/w_960,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 960w,https://res.cloudinary.com/cta/image/upload/w_480,ar_3:2,g_faces:center,f_auto,c_fill/{{ image.metadata.id }} 480w"
            sizes="(min-width: 480px) 100vw, (min-width: 768px) 15vw"
            alt="{{ image.metadata.title }}"
            />
    </picture>
{% endmacro %}

{% macro cover(image, class) %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    <img
        class="{{ class }}"
        src="https://res.cloudinary.com/cta/image/upload/w_480/{{ image.metadata.id }}"
        srcset="https://res.cloudinary.com/cta/image/upload/w_480/{{ image.metadata.id }} 480w,https://res.cloudinary.com/cta/image/upload/w_320/{{ image.metadata.id }} 320w,https://res.cloudinary.com/cta/image/upload/w_240/{{ image.metadata.id }} 240w"
        sizes="100vw, (min-width: 480px) 480px"
        alt="{{ image.metadata.title|t(locales) }}"
        />
{% endmacro %}

{% macro contentBlock_cover(contentBlock, class) %}

    {% if contentBlock %}

        {% if contentBlock|first.url is defined %}
            {% set imagebasename = contentBlock|first.url|getFileBaseName() %}
        {% else %}
            {% set imagebasename = contentBlock|first.id %}
        {% endif %}

        {% set imagedimensions = ('https://res.cloudinary.com/cta/image/upload/w_240,c_limit,f_auto,q_auto/' ~ imagebasename)|getImageDimensions() %}

        {% if imagedimensions.width %}
            <img
                class="{{ class }}"
                src="https://res.cloudinary.com/cta/image/upload/w_480/{{ imagebasename }}"
                srcset="https://res.cloudinary.com/cta/image/upload/w_480/{{ imagebasename }} 480w,https://res.cloudinary.com/cta/image/upload/w_320/{{ imagebasename }} 320w,https://res.cloudinary.com/cta/image/upload/w_240/{{ imagebasename }} 240w"
                sizes="100vw, (min-width: 480px) 480px"
                alt="{{ contentBlock|first.about|t(locales)|default('') }}"
                />
        {% endif %}

    {% else %}

    {% endif %}

{% endmacro %}

{% macro card(image, class = '', wide = false) %}
    {% import _self as me %}
    {% set locales = {'en-GB': 'en', 'fr-FR': 'fr', 'es-ES': 'es', 'pt-PT': 'pt'} %}

    {% if wide %}
        <img
            class="image image--stretch"
            src="https://res.cloudinary.com/cta/image/upload/w_240,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }}"
            srcset="https://res.cloudinary.com/cta/image/upload/w_500,ar_3:4,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 500w,https://res.cloudinary.com/cta/image/upload/w_500,ar_2:4,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 320w,https://res.cloudinary.com/cta/image/upload/w_240,ar_2:3,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 240w,https://res.cloudinary.com/cta/image/upload/w_160,ar_3:2,f_auto,c_fill/{{ image.metadata.id|default(image.external.data.public_id)|default('wwewgktde0mnowuzrvmi') }} 160w"
            sizes="(min-width: 1024px) 17vw, (min-width: 768px) 50vw"
            width="160"
            height="240"
            alt=""
            />
    {% else %}
        {{ me.post(image, class) }}
    {% endif %}
{% endmacro %}
