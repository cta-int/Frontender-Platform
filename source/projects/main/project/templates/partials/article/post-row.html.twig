{% import "macros/date.html.twig" as date %}
{% import "macros/concept.html.twig" as concept %}
{% import "macros/image.html.twig" as image %}
{% import "macros/author.html.twig" as author %}
{% import "macros/label.html.twig" as label %}
{% set locales = {'en-GB': 'en', 'fr-FR': 'fr'} %}

<div class="media  |  post">
    <div class="media__body  |  gutter">
        {% if config.show_publication_date|default(1) %}
            {{ date.article(article.datePublished) }}
        {% endif %}

        {% if config.show_publication|default(1) and article.link.label|filterArray('type', 'publication')|length %}
            <span class="meta">{{ 'in'|t(locales) }} {{ label.publications(article.link.label|filterArray('type', 'publication'), ' '~'and'|t(locales)~' ')}}</span>
        {% endif %}

        {% if config.show_type|default(1) %}
            <a class="meta" href="/search?q=&location=&time=&type=article.{{ article.articleType }}">{{ ('content_type_category_' ~ article.articleType)|t }}</a>
        {% endif %}

        <h3 class="title  |  anchor--reset">
            <a class="anchor anchor--shy  |  is-heir" href="{{ route({'page': article.path, 'slug': article.headline|t(locales)|slugify, id: article._id}) }}">
                {{ article.headline }}
            </a>
  	    </h3>

        {% if config.show_author_name and article.link.person.author|length %}
            <p class="post__author  |  author">
                {{ author.long(article.link.person.author) }}
            </p>
        {% endif %}

        {% if config.show_topic and article.analysis.agrovoc.concepts | first.broader | first.label | length > 0 %}
            <p class="author  |  leader--tiny">{{ 'in'|t(locales) }}
                <a href="{{ route({'page': 'search'}) ~ '?concepts[]=' }}{{ article.analysis.agrovoc.concepts|first.broader|first._id }}">{{ article.analysis.agrovoc.concepts|first.broader|first.label|t(locales) }}</a>
            </p>
        {% endif %}

        {% if config.show_stand_first|default(1) %}
           <p class="post__intro">{{ article.about|raw }}</p>
        {% endif %}

        {% if config.show_read_more|default(1) %}
           <a class="read-more" href="{{ route({'page': article.path, 'slug': article.headline|t(locales)|slugify, id: article._id}) }}">{{ 'Read more'|t(locales) }}</a>
        {% endif %}
    </div>
    {% if config.show_lead_image|default(1) and article.link.mediaObject|lead %}
        <div class="media__figure  |  trailer--tiny">
            <a class="anchor anchor--shy" href="{{ route({'page': article.path, 'slug': article.headline|t(locales)|slugify, id: article._id}) }}">
                {{ image.post(article.link.mediaObject|lead) }}
            </a>
        </div>
    {% endif %}
</div>
